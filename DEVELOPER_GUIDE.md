# Руководство разработчика — World of Empires (client)

**Начни с этого файла.** Здесь всё, что нужно новому разработчику: как устроен проект, как работать с кодом и как правильно фиксировать изменения.

---

## 1. О проекте

- **Стек:** Next.js 16, React 19, TypeScript, Pixi.js 8, Tailwind CSS 4, Bun
- **Структура:** разделение на слои `game` (логика) → `engine` (Pixi) → `modules` (React) → `app` (роутинг)

---

## 2. Документация проекта

| Файл | Для кого | Содержание |
|------|----------|------------|
| **DEVELOPER_GUIDE.md** (этот) | Новый разработчик | Обзор, запуск, workflow, как фиксировать изменения |
| **ARCHITECTURE.md** | Все | Правила архитектуры, структура папок, именование, path aliases |
| **AI_CONTEXT.md** | ИИ + разработчик | Что уже реализовано: API, функции, компоненты. Контекст для генерации кода |
| **CHANGELOG.md** | Все | История изменений по версиям |
| **ROADMAP.md** | Все | План развития, выполненные и запланированные фазы |

---

## 3. Быстрый старт

```bash
# Установка
bun install

# Запуск dev-сервера
bun run dev
```

Открой http://localhost:3000 — главная страница. Кнопка «Start Game» → `/game` — изометрическая карта.

---

## 4. Архитектура (кратко)

```
app/       → Роутинг Next.js, импортирует из modules
modules/   → React-компоненты, страницы (home, game)
engine/    → Pixi.js: камера, рендер карты, текстуры
game/      → Чистая логика: типы, генерация карты, шум (без React, без Pixi)
```

**Правило:** `game` не зависит от `engine` и `modules`. `engine` зависит только от `game`.

Подробности: **ARCHITECTURE.md**

---

## 5. Как вносить изменения

### 5.1. Перед началом

- Прочитай **ARCHITECTURE.md** — куда класть файлы, как именовать
- Открой **AI_CONTEXT.md** — какие функции и компоненты уже есть, чтобы не дублировать

### 5.2. Стилизация

- **Только Tailwind или inline-стили:** см. ARCHITECTURE.md → «Стилизация UI»
- Не создавать `.css` / `.module.css` для компонентов
- Предпочитать Tailwind; `style={}` — для динамических значений

### 5.3. Именование файлов

- **kebab-case:** `game-canvas.tsx`, `map-generator.ts`
- **index.ts** — только re-export, без реализации

### 5.4. Path aliases

```ts
import { generateMap, TileType } from '@/game'
import { MapRenderer, loadAllTileTextures } from '@/engine'
import { GamePage } from '@/modules/game'
```

---

## 6. Как правильно зафиксировать изменения

После того как код готов, выполни по порядку.

### Шаг 1: Проверка кода

- [ ] Приложение работает (проверь в браузере)
- [ ] `bun run lint` — без ошибок
- [ ] `npx tsc --noEmit` — компилируется

### Шаг 2: Документация

| Что изменил | Что обновить |
|-------------|--------------|
| Новая функция, тип, компонент | **AI_CONTEXT.md** — добавить в таблицу |
| Изменил сигнатуру API | **AI_CONTEXT.md** — обновить строку |
| Удалил экспорт | **AI_CONTEXT.md** — удалить строку |
| Новая папка, новые правила | **ARCHITECTURE.md** |
| Только внутренний рефакторинг | Документацию можно не трогать |

### Шаг 3: CHANGELOG

Добавь запись в начало **CHANGELOG.md**:

```markdown
## [X.Y.Z] — ДД.ММ.ГГГГ

**Краткое описание** | Что сделано

### Добавлено / Изменено / Исправлено

- **файл** — что изменилось
```

### Шаг 4: Версия

Обнови `package.json` → `"version": "X.Y.Z"`:

- **Патч** (0.2.2 → 0.2.3): исправления, рефакторинг
- **Минор** (0.2.2 → 0.3.0): новая функциональность
- **Мажор** (0.2.2 → 1.0.0): breaking changes

### Шаг 5: Версия в документах

- **AI_CONTEXT.md** — в конце: `*Документ актуален для версии X.Y.Z*`
- **ROADMAP.md** — «Текущая версия» и таблица (если нужно)

### Шаг 6: Коммит

```bash
git add -A
git status
git commit -m "vX.Y.Z: Краткое описание

- Деталь 1
- Деталь 2"
```

---

## 7. Памятка (кратко)

```
Код готов
    ↓
Обнови AI_CONTEXT (если новый/изменённый API)
    ↓
Добавь запись в CHANGELOG
    ↓
Подними версию в package.json
    ↓
Обнови версию в AI_CONTEXT, ROADMAP
    ↓
git add → commit
```

**Добавил новый код → обнови AI_CONTEXT.md.**  
**Поменял структуру проекта → обнови ARCHITECTURE.md.**

---

## 8. Работа с ИИ

При генерации кода через ИИ прикрепляй:

- **ARCHITECTURE.md** — правила и структура
- **AI_CONTEXT.md** — что уже реализовано

Промпт-шаблон:

```
Проект: World of Empires (client).
Архитектура: ARCHITECTURE.md
Реализованный код: AI_CONTEXT.md

Задача: [описание]

Учитывай существующие модули, не дублируй код, следуй kebab-case.
```

---

## 9. Автоматическая финализация (промпт для ИИ)

После завершения разработки скопируй промпт из **PROMPT_FINALIZE.md** и вставь в чат с ИИ. ИИ автоматически:

- проанализирует изменения
- определит тип версии (patch/minor)
- обновит CHANGELOG, ROADMAP, AI_CONTEXT
- проверит lint и tsc
- создаст git commit

---

## 10. Куда смотреть дальше

| Вопрос | Документ |
|--------|----------|
| Как стилизовать компоненты? | ARCHITECTURE.md → «Стилизация UI» (Tailwind или inline) |
| Куда положить новый файл? | ARCHITECTURE.md → «Куда помещать файлы» |
| Какие функции уже есть? | AI_CONTEXT.md |
| Как назвать файл? | ARCHITECTURE.md → «Правила именования» |
| История изменений? | CHANGELOG.md |
| План развития? | ROADMAP.md |
| Автофинализация через ИИ? | PROMPT_FINALIZE.md |

---

*Версия руководства: 0.2.2*
